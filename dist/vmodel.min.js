/*! vmodel 2014-12-24 */

!function(a,b,c){function d(a){return new i(a)}function e(){var a,b,c,f,g,h,i=arguments[0]||{},j=1,k=arguments.length,l=!1;for("boolean"==typeof i&&(l=i,i=arguments[1]||{},j=2),"object"!=typeof i&&"function"!=typeof i&&(i={}),k===j&&(i=this,--j);k>j;j++)if(null!=(a=arguments[j]))for(b in a)c=i[b],f=a[b],i!==f&&(l&&f&&(d.type(f,"object")||(g=d.type(f,"array")))?(g?(g=!1,h=c&&d.type(c,"object")?c:[]):h=c&&d.type(c,"object")?c:{},i[b]=e(l,h,f)):void 0!==f&&(i[b]=f));return i}function f(a){return-1==a.indexOf("-")?a:a.replace(O,function(a){return a.charAt(1).toUpperCase()})}function g(c){c=d.extend({},L.ajax,c);var e=new(a.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP"),f=null;if(c.data&&(f=d.param(c.data),"get"==c.type.toLowerCase()&&(c.url+=~c.url.indexOf("?")?"&"+f:"?"+f,f=null)),e.open(c.type,c.url,c.async),c.headers){var g;for(g in c.headers)e.setRequestHeader(g,c.headers[g])}e.setRequestHeader("Content-Type",c.contentType),e.onreadystatechange=function(){if(4==this.readyState)if(this.status>=200&&this.status<300){var a=this.responseText;switch(c.dataType){case"json":try{a=V(a)}catch(d){a=null}break;case"html":try{var e=b.createElement("div");e.innerHTML=a,a=e.firstChild,e.removeChild(a),e=null}catch(d){a=null}break;case"script":break;case"jsonp":}c.success&&c.success.call(c,a,this)}else c.error&&c.error.call(c,this,decodeURIComponent(this.statusText))},e.send(f)}function h(a,b,c){var d,e,f,g;if(~b.indexOf("."))for(g=b.split("."),e=a,d=0;d<g.length;d++)f=g[d],d==g.length-1?e[f]=c:e[f]||(e[f]={}),e=e[f];else a[b]=c}function i(a){if(e(this,a),this.$parent=null,this.$childs=[],this.$element=null,this.$freeze=!1,this.$cache={},this.$watchs={},this.$id){if(P[this.$id])throw new Error("The model id is exists.")}else this.$id="$"+Math.random().toString(36).substr(2);P[this.$id]=this}function j(a,b){var c=[];try{for(var d in a.$watchs)("*"==d||d.startsWith(b))&&(c=c.concat(a.$watchs[d]))}finally{return c}}function k(a){try{return P[a.$modelId]}catch(b){return null}}function l(a){var b=a.$modelId;if(b)return P[b];for(;a=a.parentNode;)if(a.$modelId)return P[a.$modelId];return null}function m(a){return k(a)||l(a)}function n(a,b){a.$childs.length&&a.$childs.forEach(function(a){n(a,b)}),delete P[a.$id],a.$element&&(b?a.$element.parentNode.removeChild(a.$element):a.$element.$modelId=void 0),a=null}function o(a,c){switch(a=a||b.documentElement,c||(c=new i,c.$bindElement(a)),a.nodeType){case 1:L.igonreTags[a.tagName]||(c=q(a,c)||c,!a.$noScanChild&&a.childNodes.length&&p(a,c));break;case 3:r(a,c)}}function p(a,b){for(var c=a.firstChild;c;)o(c,b),c=c.$nextSibling||c.nextSibling}function q(a,b){for(var c,e,f,g=a.attributes,h=s(g),i=h.length;i--;)if(c=h[i],f=g[c.index],e=d.scanners[c.type],e&&(b=e(b,a,f.value,f,c.param)||b),a.$skipOtherAttr){delete a.$skipOtherAttr;break}return b}function r(a,b){u(b,a.data,w,function(b){a.data=b})}function s(a){var b=[];if(0===a.length)return b;for(var c,e,f,g,h=a.length;h--;)if(c=a[h],c.specified&&!L.igonreAttrs[c.name]){if(e=void 0,c.name.startsWith("x-"))f=c.name.indexOf("-",2),~f?(g=c.name.substr(0,f),e=c.name.substr(f+1)):g=c.name;else{if(!d.scanners[c.name])continue;g=c.name}b.push({index:c.name,type:g,param:e,priority:L.priorities[g]||1e3})}return 0===b.length?b:(b.sort(function(a,b){return a.priority<b.priority}),b)}function t(a,b,c,e){var f=e.name.substr(2),g=B(c),h=new Function("$model",g);b.removeAttribute(e.name),d.on(b,f,function(){return h(a)})}function u(a,b,c,e){var f={},g=c(b,f);if(d.isEmptyObject(f))return!1;var h=new Function("$model,filter","return "+g),i={update:function(a){e(h(a,d.filter))}};for(var j in f)a&&(a.$watch(j,i),i.update(a))}function v(a,b){this.id=a,this.element=b,R[a]=this}function w(a,b){for(var c='""',d=L.interpolate[0],e=L.interpolate[1],f=d.length,g=e.length,h=!1,i=0,j=0,k=0;;){if(j=a.indexOf(d,j),!~j){c+='+"'+x(a.substr(i))+'"';break}if(k=a.indexOf(e,j+f),!~k){c+='+"'+x(a.substr(i))+'"';break}h=!0,c+='+"'+x(a.substring(i,j))+'"+'+y(a.substring(j+f,k),b,!0),i=j=k+=g}return h?c:!1}function x(a){return a.replace(/\r/g,"\\r").replace(/\n/g,"\\n")}function y(a,b,c){try{var d=[],a=z(a,d),e=C(a.trim(),b,c);if(d.length){for(var f,g="(function(expr){",h=0;h<d.length;h++)f=d[h],g+='expr=filter("'+f.name+'",expr'+(f.args.trim()?","+f.args:"")+");";e=g+"return expr;}("+e+"))"}return e}catch(i){return""}}function z(a,b){for(var c,d=0;;){if(d=a.indexOf("|",d),!~d){c=a,b=[];break}if("|"!=a.charAt(d+1)){a.substr(d+1).split("|").forEach(function(a){var c=A(a);b.push(c)}),c=a.substr(0,d-1);break}d+=2}return c}function A(a){var b=S.exec(a);return{name:b[1],args:b[2]}}function B(a){var b={},c="";if(~a.indexOf(";"))for(var d=a.split(";"),e=0;e<d.length;e++)e&&(c+=";"),c+=B(d[e].trim());else if(~a.indexOf("=")){var f=a.split("=");c='$model.$set("'+f[0].trim()+'",'+C(f[1].trim(),b)+")"}else c=C(a,b)+";";return c}function C(a,b,c){var d=a.charAt(0);if('"'==d||"'"==d)return a;var e=a.match(T);if(e){for(var f,g,h="",i=0,j=0;j<e.length;j++)g=a.indexOf(e[j],i),f=a.substring(i,g),h+=D(f,c)+e[j],i=g+e[j].length,-1==e[j].indexOf("(")&&(b[f]=!0);if(a.length>i){f=a.substr(i);var k=D(f,c);k!=f&&(b[f]=!0),h+=k}return h}return h=D(a,c),h!=a&&(b[a]=!0),h}function D(a,b){if(!a)return"";if(L.keywords[a])return a;if(U.test(a))return a;var c=a.charAt(0);return'"'==c||"'"==c?a:'$model.$get("'+a+'"'+(b?",0,1":"")+")"}function E(a){if(!a)return null;switch(/^\d{10}$|^\d{13}$/.test(a)&&(a=+a),d.type(a)){case"string":return F(a);case"date":return a;case"number":return G(a);default:return null}}function F(a){var b=Date.parse(a);if(!isNaN(b))return G(b);if(b=Date.parse(a.replace(/-/g,"/")),!isNaN(b))return G(b);var c=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}\:\d{2}:\d{2})\.(\d{3})Z$/,d=a.match(c);return d?G(Date.parse(d[1]+"/"+d[2]+"/"+d[3]+" "+d[4])+ +d[5]):null}function G(a){return 1e11>a&&(a*=1e3),new Date(a)}function H(a,b){return a?b.replace(/[a-zA-Z]+/g,function(b){switch(b){case"yyyy":return a.getFullYear();case"mm":return I(a.getMonth()+1);case"m":return a.getMonth()+1;case"dd":return I(a.getDate());case"d":return a.getDate();case"hh":return I(a.getHours());case"h":return a.getHours();case"MM":return I(a.getMinutes());case"M":return a.getMinutes();case"ss":return I(a.getSeconds());case"s":return a.getSeconds();case"ww":return"\u661f\u671f"+"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[a.getDay()];case"w":return"\u5468"+"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[a.getDay()];case"l":return"";default:return b}}):""}function I(a){return a>9?a:"0"+a}function J(a,b){a.form&&(d.on(a,"keyup",b),d.on(a,"change",b))}function K(a,b,c){var d,e,f=a.form,g=m(f);g&&(d=a.name,e=g.$xform+"."+a.name,g.$set(e+".$valid",c),g.$set(e+".$error."+b,!c))}var L={interpolate:["{{","}}"]};L.igonreTags={SCRIPT:!0,NOSCRIPT:!0,IFRAME:!0},L.igonreAttrs={"x-ajax-if":!0},L.priorities={"x-skip":0,"x-repeat":10,"x-controller":20,"x-if":50};var M=(!"1"[0],a==b&&b!=a),N={url:/^https?\:\/\/[-a-z0-9\.]+(\/.*)?$/,email:/^[\w\.\-]+\@[-a-z0-9]+\.\w+$/,number:/^\-?\d*\.?\d+$/,phone:/^1\d{10}$/,telphone:/^0\d{10,11}/,idcard:/^\d{6}(19\d{2}|20\d{2})(0\d|1[012])([012]\d|3[01])\d{3}[\dx]$/};e(d,{extend:e,isEmptyObject:function(a){var b;if(!d.type(a,"object"))return!1;for(b in a)return!1;return!0},type:function(a,b){if(b)return d.type(a)==b;var c={},e=c.toString.call(a);return null===a?"null":void 0===a?"undefined":e.slice(8,-1).toLowerCase()},ready:function(a){b.addEventListener?b.addEventListener("DOMContentLoaded",function(){a()},!1):setTimeout(a)},addClass:function(a,b){a.classList?a.classList.add(b):a.className?~a.className.split(" ").indexOf(b)||(a.className=a.className+" "+b):a.className=b},removeClass:function(a,b){if(a.classList)a.classList.remove(b);else if(a.className){var c=a.className.split(" ");c.remove(b),a.className=c.join(" ")}},css:function(b,c,d){if(2==arguments.length){var e=a.getComputedStyle?a.getComputedStyle(b):b.currentStyle,f=e[c];return f}b.style[c]=d},on:function(a,b,c){if(d.type(b,"object"))for(var e in b)d.on(a,e,b[e]);else a.addEventListener?a.addEventListener(b,function(b){var d=c.call(a,b);d===!1&&(b.preventDefault(),b.stopPropagation())},!1):a.attachEvent&&a.attachEvent("on"+b,function(b){var d=c.call(a,b);d===!1&&(b.returnValue=!1,b.cancelBubble=!0)})},emit:function(a,b){if(M)a.fireEvent("on"+b);else{var c=new Event(b);a.dispatchEvent(c)}},config:function(a,b){L.hasOwnProperty(a)?L[a]=b:d.isPlainObject(a)&&e(L,a)}}),"".startsWith||(String.prototype.startsWith=function(a){return 0===this.indexOf(a)}),Array.prototype.remove=function(a){for(var b=this.length;b--;)a==this[b]&&this.splice(b,1)};var O=/-[^-]/g;L.ajax={async:!0,type:"GET",dataType:"text",contentType:"application/x-www-form-urlencoded"},d.param=function(b,c){if("string"==typeof b)return a.encodeURIComponent(b);if("number"==typeof b)return b.toString();if(!b)return"";var e,f,g=[];c=c||"";for(e in b)b.hasOwnProperty(e)&&!d.type(b[e],"function")&&(f=c?c+"["+e+"]":e,g.push("object"==typeof b[e]?d.param(b[e],f):f+"="+a.encodeURIComponent(b[e]||"")));return g.join("&")},d.ajax=g;var P={};if(i.prototype={$get:function(a,b,c){if(this.$cache.hasOwnProperty(a))return this.$cache[a];if(!~a.indexOf("."))return"function"==typeof this[a]?this[a].bind(this):this[a]?this[a]:this.hasOwnProperty(a)?c?"":this[a]:b?c?"":void 0:this.$parent?this.$parent.$get(a,b,c):c?"":void 0;for(var d,e=this,f=a.split("."),g=0;g<f.length;g++){if(d=f[g],!e[d])return e.hasOwnProperty(d)?c?"":e[d]:b?c?"":void 0:this.$parent?this.$parent.$get(a,b,c):c?"":void 0;if("function"==typeof e[d])return e[d].bind(e);if(g==f.length-1)return e[d];e=e[d]}},$set:function(a,b){if(d.type(a,"object")){var c,e=b?b+".":"";this.$freeze=!0;for(c in a)this.$cache[e+c]=a[c],h(this,e+c,a[c]);this.$freeze=!1;for(c in a)this.$fire(e+c);for(c in a)delete this.$cache[e+c]}else h(this,a,b),this.$cache[a]=b,this.$fire(a),delete this.$cache[a]},$watch:function(a,b){this.$watchs[a]||(this.$watchs[a]=[]),this.$watchs[a].push(b)},$unwatch:function(a,b){this.$watchs[a]&&this.$watchs[a].remove(b)},$fire:function(a){if(!this.$freeze)for(var b=j(this,a),c=0;c<b.length;c++)b[c].update(this,a)},$bindElement:function(a,b){if(a.$modelId)throw new Error("\u4e0d\u80fd\u91cd\u590d\u7ed1\u5b9amodel.");var c=this;if(!b&&(c.$parent=l(a),c.$parent)){c.$parent.$childs.push(c);var d={update:function(a,b){c.hasOwnProperty(b)||c.$fire(b)}};c.$parent.$watch("*",d)}a.$modelId=c.$id,this.$element=a}},d.model=function(a){return"string"==typeof a?P[a]||null:m(a)||null},d.scan=o,!"".trim){var Q=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(Q,"")}}Array.prototype.forEach||(Array.prototype.forEach=function(a){for(var b=0;b<this.length;b++)a(this[b],b)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(a==this[b])return b;return-1}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1}),Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a)}}),d.scanners={},["blur","focus","focusin","focusout","load","resize","scroll","unload","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","change","select","submit","keydown","keypress","keyup","error","contextmenu"].forEach(function(a){d.scanners["x-"+a]=t}),d.extend(d.scanners,{"x-skip":function(a,b,c,d){b.removeAttribute(d.name),b.$noScanChild=!0},href:function(a,b,c){"A"==b.tagName&&""===c&&d.on(b,"click",function(){return!1})},"x-controller":function(a,b,c,e,f){return a=P[c],b.removeAttribute(e.name),d.removeClass(b,"x-controller"),a&&!a.element?(a.$bindElement(b,"top"!=f),a):void 0},"x-init":function(a,b,c,d){if(a){b.removeAttribute(d.name);var e=B(c),f=new Function("$model",e);f(a)}},"x-template":function(a,b,c,e){b.$nextSibling=b.nextSibling,b.$noScanChild=!0,b.removeAttribute(e.name),d.removeClass(b,"x-template"),new v(c,b),b.parentNode.removeChild(b)},"x-include":function(a,b,c,e){b.$noScanChild=!0,b.removeAttribute(e.name),d.removeClass(b,"x-include"),u(a,c,y,function(c){if(R[c]){var d=R[c].element.cloneNode(!0);M&&(d.$noScanChild=!1),b.innerHTML="",b.appendChild(d),o(d,a)}else g({url:c,cache:!0,dataType:"html",success:function(d){var e=new v(c,d),f=e.element.cloneNode(!0);b.innerHTML="",b.appendChild(f),o(f,a)},error:function(){throw new Error("Cannot find template: "+c)}})})},"x-repeat":function(a,c,e,f,g){var h=c.parentNode,j=b.createComment("x-repeat-start:"+g),l=b.createComment("x-repeat-end:"+g);h.insertBefore(j,c),h.insertBefore(l,c.nextSibling),c.$nextSibling=c.nextSibling,c.$noScanChild=!0,c.$skipOtherAttr=!0,c.removeAttribute(f.name),d.removeClass(c,"x-repeat"),c.parentNode.removeChild(c),u(a,e,y,function(a){if(d.type(a,"array")){for(var b,e=j.nextSibling;e&&e!=l;)b=k(e),n(b,!0),e=j.nextSibling;a.forEach(function(b,d){var e=c.cloneNode(!0);M&&(e.$noScanChild=!1);var f=new i({$index:d,$remove:function(){n(f,!0)},$first:!d,$last:d==a.length,$middle:d>0&&d<a.length});f[g]=b,h.insertBefore(e,l),f.$bindElement(e),o(e,f)})}})},"x-if":function(a,c,e,f){var g=c.parentElement,h=l(c),j=b.createComment("x-if:"+a.$id);return c.$nextSibling=c.nextSibling,c.removeAttribute(f.name),d.removeClass(c,"x-if"),a=k(c)||new i,c.$modelId||a.$bindElement(c),u(h,e,y,function(b){if(b){c.parentElement||g.replaceChild(c,j),a.$freeze=!1;for(var d in a.$watchs)a.$fire(d)}else c.parentElement&&g.replaceChild(j,c),a.$freeze=!0}),a},"x-show":function(a,b,c,e){b.removeAttribute(e.name),d.removeClass(b,"x-show"),u(a,c,y,function(a){b.style.display=a?"":"none"})},"x-bind":function(a,b,c,e){function f(e){d.on(b,e,function(){a.$set(c,b.value)})}switch(b.removeAttribute(e.name),u(a,c,y,function(a){"INPUT"==b.tagName?"radio"==b.type?b.checked=a==b.value?!0:!1:"checkbox"==b.type?b.checked=!a||~a.indexOf(b.value)?!0:!1:b.value=a||"":b.value=a||""}),b.tagName){case"INPUT":switch(b.type){case"checkbox":var g=a.$get(c);if(g&&!d.type(g,"array"))throw new TypeError("Checkbox bind must be array.");g||a.$set(c,[]),d.on(b,"click",function(){var d=a.$get(c),e=b.value;b.checked?d.push(e):d.remove(e),a.$set(c,d)});break;case"radio":f("click");break;default:f("keyup"),f("change")}break;case"SELECT":f("change");break;case"TEXTAREA":f("keyup"),f("change")}},"x-class":function(a,b,c,e,f){b.removeAttribute(e.name),d.removeClass(b,"x-class"),u(a,c,y,function(a){a?d.addClass(b,f):d.removeClass(b,f)})},"x-attr":function(a,b,c,d,e){b.removeAttribute(d.name),u(a,c,w,function(a){a?b.setAttribute(e,a):b.removeAttribute(e)})},"x-ajax":function(a,b,c,e,f){b.removeAttribute(e.name),d.removeClass(b,"x-ajax"),b.$modelId||(a=new i,a.$bindElement(b));var h,j=!0,k=b.getAttribute("x-ajax-if"),l=function(){g({type:"GET",dataType:"json",cache:!1,url:h,success:function(b){a.$set(b,f)},error:function(b,c){a.$set(f+".$error",c)}})};a[f]={$read:l},k&&(b.removeAttribute("x-ajax-if"),u(a,k,y,function(a){j=a}));var m=u(a,c,w,function(a){h=a,j&&l()});return m===!1&&(h=c,j&&l()),a},"x-style":function(a,b,c,e,g){var h=f(g);b.removeAttribute(e.name),d.removeClass(b,"x-style"),u(a,c,y,function(a){b.style[h]=a})}});var R={},S=/(\w+)(.*)/,T=/[^\w\$\.\"\']+/g;L.keywords={},"$model return if else true false null undefined NaN do while typeof instanceof function void with var this try throw catch new in for break continue switch default delete".split(" ").forEach(function(a){L.keywords[a]=!0});var U=/^\-?\d?\.?\d+$/,V=a.JSON?a.JSON.parse:function(a){return new Function("","return "+a.trim())()};d.ready(o),a.vmodel=d,d.filters={date:function(a,b){var c=E(a);return H(c,b)},limit:function(a,b,c){return a.length<=b?a:(c=c||"...",a.substring(0,b)+c)},number:function(a,b){return a=+a,a.toFixed(b)},"default":function(a,b,c){return c&&void 0===a||!a?b:a},text:function(a,c){if(!a)return"";var d,e=b.createElement("div");return c?(e.innerHTML=a,d=e.innerText):(e.innerText=a,d=e.innerHTML),e=null,d}},d.filters.date.format=function(a,b){dateFormatter[a]=b},d.filter=function(a,b,c){var e=d.filters[a];return e?(arguments.length>2?(c=Array.prototype.slice.call(arguments),c.shift()):c=[b],e.apply(null,c)):b},e(d.scanners,{"x-form":function(a,b,c,d,f){return b.removeAttribute(d.name),e(a,{$xform:f,$dirty:!1,$valid:!0}),a},min:function(a,b,c){var d=+c;J(b,function(){K(b,"min",+b.value>=d)})},max:function(a,b,c){var d=+c;J(b,function(){K(b,"max",+b.value<=d)})},minlength:function(a,b,c){var d=+c;J(b,function(){K(b,"minlength",b.value.length>=d)})},maxlength:function(a,b,c){var d=+c;J(b,function(){K(b,"maxlength",b.value.length<=d)})},pattern:function(a,b,c){var d=new RegExp(c);J(b,function(){K(b,"pattern",b.value.test(d))})},required:function(a,b){J(b,function(){K(b,"required",!!b.value)})},type:function(a,b,c){c=c.toLowerCase(),N[c]&&J(b,function(){K(b,"type",b.value.test(N[c]))})}})}(window,document,location,history);
//# sourceMappingURL=vmodel.min.js.map