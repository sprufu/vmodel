/*! vmodel 2014-12-10 */
!function(a,b,c){function d(){var a,b,c,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[1]||{},i=2),"object"==typeof h||M.isFunction(h)||(h={}),j===i&&(h=this,--i);j>i;i++)if(null!=(a=arguments[i]))for(b in a)c=h[b],e=a[b],h!==e&&(k&&e&&(M.isPlainObject(e)||(f=M.isArray(e)))?(f?(f=!1,g=c&&M.isArray(c)?c:[]):g=c&&M.isPlainObject(c)?c:{},h[b]=d(k,g,e)):void 0!==e&&(h[b]=e));return h}function e(){}function f(a){return-1==a.indexOf("-")?a:a.replace(S,function(a){return a.charAt(1).toUpperCase()})}function g(a,b,c,d){var e={},f=c(b,e);if(!M.isEmptyObject(e)){var g=new Function("$model","return "+f),h={update:function(a,b){d(g(a,b))}};for(var i in e)a&&(a.$subscribe(i,h),h.update(a))}}function h(b){b=M.extend({},N.ajax,b);var c=new(a.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP"),d=null;if(b.data&&(d=i(b.data),"get"==b.type.toLowerCase()&&(b.url+=~b.url.indexOf("?")?"&"+d:"?"+d,d=null)),c.open(b.type,b.url,!0),b.headers){var e;for(e in b.headers)c.setRequestHeader(e,b.headers[e])}c.onreadystatechange=function(){if(4==this.readyState)if(this.status>=200&&this.status<300){var a=this.responseText;switch(b.dataType){case"json":try{a=$(a)}catch(c){a=null}break;case"script":break;case"jsonp":}b.success&&b.success.call(b,a,this)}else b.error&&b.error.call(b,this,this.responseText)},c.send(d)}function i(b){if("string"==typeof b)return b;if("number"==typeof b)return b.toString();if(!b)return"";var c,d=[];for(c in b)d.push(c+"="+a.encodeURIComponent(b[c]||""));return d.join("&")}function j(a,b,c){var d,e,f,g;if(~b.indexOf("."))for(g=b.split("."),e=a,d=0;d<g.length;d++)f=g[d],d==g.length-1?e[f]=c:e[f]?e=e[f]:e[f]={};else a[b]=c}function k(a){if(d(this,a),this.$parent=null,this.$childs=[],this.$element=null,this.$freeze=!1,this.$subscribes={},this.$id){if(T[this.$id])throw new Error("The model id is exists.")}else this.$id="$"+Math.random().toString(36).substr(2);T[this.$id]=this}function l(a){return null===a||void 0===a?a:a}function m(a,b){var c=[];try{for(var d in a.$subscribes)("*"==d||d.startsWith(b))&&(c=c.concat(a.$subscribes[d]))}finally{return c}}function n(a,c){switch(a=a||b.documentElement,c=c||null,a.nodeType){case 1:c=p(a,c)||c,!a.$noScanChild&&a.childNodes.length&&o(a,c);break;case 3:q(a,c);break;case 9:o(a,c)}}function o(a,b){for(var c=a.firstChild;c;)n(c,b),c=c.$nextSibling||c.nextSibling}function p(a,b){for(var c,d,e,f=a.attributes,g=r(f),h=g.length;h--;)c=g[h],e=f[c.index],d=M.scanners[c.type],d&&(b=d({model:b,element:a,type:c.type,param:c.param,value:e.value},e)||b);return b}function q(a,b){g(b,a.data,z,function(b){a.data=b})}function r(a){var b=[];if(0===a.length)return b;for(var c,d,e,f,g=a.length;g--;)if(c=a[g],c.specified){if(d=void 0,c.name.startsWith("x-"))e=c.name.indexOf("-",2),~e?(f=c.name.substr(0,e),d=c.name.substr(e+1)):f=c.name;else{if(!M.scanners[c.name])continue;f=c.name}b.push({index:c.name,type:f,param:d,priority:N.priorities[f]||1e3})}return 0===b.length?b:(b.sort(function(a,b){return a.priority>b.priority}),b)}function s(a){var b=a.value.toLowerCase(),c=a.type;b!=c&&"true"!=b&&g(a.model,a.value,A,function(b){b?a.element.setAttribute(a.type,a.type):a.element.removeAttribute(a.type)})}function t(a,b){g(a.model,a.value,z,function(a){b.value=a})}function u(a,b){var c=a.type.substr(2);a.element.removeAttribute(b.name),g(a.model,a.value,z,function(b){a.element.setAttribute(c,b)})}function v(a,b){var c=M.getExtModel(a.element),d=a.type.substr(2),e=D(a.value),f=new Function("$model",e);a.element.removeAttribute(b.name),M.on(a.element,d,function(){f(c)})}function w(a){var b,c,d,e,f,g=!0,h=a.form,i=h.$xform,j=M.getExtModel(h);for(b in V)d=a.attributes[b],d&&d.specified&&(c=V[b],c.call(a,d.value,a.value)?f=!1:(f=!0,g=!1),e=i+"."+a.name+".$error."+b,j.$get(e)!=f&&j.$set(e,f));e=i+"."+a.name+".valid",j.$get(e)!=g&&j.$set(e,g)}function x(a,b,c){this.id=a,this.element=b,this.parentModel=c,W[a]=this}function y(a){this.$$page=a.page?Q.number.test(a.page)?+a.page:+G(a.page)||1:1,this.$$pageSize=a.pageSize?Q.number.test(a.pageSize)?+a.pageSize:+G(a.pageSize)||20:20,this.$$sort="",this.$$order="",this.$$params={page:this.$$page,pageSize:this.$$pageSize},this.$$url=a.url,this.$$name=a.name,this.$read()}function z(a,b){for(var c='""',d=N.interpolate[0],e=N.interpolate[1],f=d.length,g=e.length,h=!1,i=0,j=0,k=0;;){if(j=a.indexOf(d,j),!~j){c+='+"'+a.substr(i)+'"';break}if(k=a.indexOf(e,j+f),!~k){c+='+"'+a.substr(i)+'"';break}h=!0,c+='+"'+a.substring(i,j)+'" +'+A(a.substring(j+f,k),b),i=j=k+=g}return h?c:!1}function A(a,b){try{var c=[],a=B(a,c),d=E(a.trim(),b);if(c.length){for(var e,f="(function(expr){",g=0;g<c.length;g++)e=c[g],f+='expr = $model.$filter("'+e.name+'", expr, '+e.args+");";d=f+"return expr;}("+d+"))"}return d}catch(h){return""}}function B(a,b){for(var c,d=0;;){if(d=a.indexOf("|",d),!~d){c=a,b=[];break}if("|"!=a.charAt(d+1)){a.substr(d+1).split("|").forEach(function(a){var c=C(a);b.push(c)}),c=a.substr(0,d-1);break}d+=2}return c}function C(a){var b=X.exec(a);return{name:b[1],args:b[2]}}function D(a,b){b=b||{};var c="";if(~a.indexOf(";"))for(var d=a.split(";"),e=0;e<d.length;e++)e&&(c+=";"),c+=D(d[e],b);else if(~a.indexOf("=")){var f=a.split("=");c='$model.$set("'+f[0].trim()+'", '+E(f[1].trim(),b)+")"}else c=E(a,b)+";";return c}function E(a,b){var c=a.charAt(0);if('"'==c||"'"==c)return a;var d=a.match(Y);if(d){for(var e,f,g="",h=0,i=0;i<d.length;i++)f=a.indexOf(d[i],h),e=a.substring(h,f),g+=F(e)+d[i],h=f+d[i].length,-1==d[i].indexOf("(")&&(b[e]=!0);if(a.length>h){e=a.substr(h);var j=F(e);j!=e&&(b[e]=!0),g+=j}return g}return g=F(a),g!=a&&(b[a]=!0),g}function F(a){return"true"==a||"false"==a||"null"==a||"undefined"==a||"NaN"==a?a:Z.test(a)?a:'$model.$get("'+a+'")'}function G(a,b,d){return null===R&&(R={},c.search&&decodeURIComponent(c.search).substr(1).split("&").map(function(a){var b=a.split("=");R[b[0]]=b[1]})),b?void(b[a]=R[a]||d):R[a]}function H(a){if(!a)return null;switch(M.type(a)){case"string":return I(a);case"date":return a;case"number":return J(a);default:return null}}function I(a){var b=Date.parse(a);if(!isNaN(b))return J(b);if(b=Date.parse(a.replace(/-/g,"/")),!isNaN(b))return J(b);var c=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}\:\d{2}:\d{2})\.(\d{3})Z$/,d=a.match(c);return d?J(Date.parse(d[1]+"/"+d[2]+"/"+d[3]+" "+d[4])+ +d[5]):null}function J(a){return 1e11>a&&(a*=1e3),new Date(a)}function K(a,b){return b.replace(/[a-zA-Z]+/g,function(b){var c=_[b];return c?c(a):c})}function L(a){return a>9?a:"0"+a}var M={},N={interpolate:["{{","}}"]},O=!"1"[0],P=a==b&&b!=a,Q={url:/^https?\:\/\/[-a-z0-9\.]+(\/.*)?$/,email:/^[\w\.\-]+\@[-a-z0-9]+\.\w+$/,number:/^\-?\d*\.?\d+$/,phone:/^1\d{10}$/,telphone:/^0\d{10,11}/,idcard:/^\d{6}(19\d{2}|20\d{2})(0\d|1[012])([012]\d|3[01])\d{3}[\dx]$/},R=null;d(M,{extend:d,noop:e,isFunction:function(a){return"function"==typeof a},isArray:function(a){return"array"==M.type(a)},isPlainObject:function(a){return"object"==M.type(a)},isEmptyObject:function(a){var b;if("object"!=M.type(a))return!1;for(b in a)return!1;return!0},type:function(a){var b={},c=b.toString.call(a);return null===a?"null":void 0===a?"undefined":c.slice(8,-1).toLowerCase()},ready:function(a){b.addEventListener?b.addEventListener("DOMContentLoaded",function(){a()},!1):setTimeout(a)},addClass:function(a,b){a.classList?a.classList.add(b):a.className?~a.className.split(" ").indexOf(b)||(a.className=a.className+" "+b):a.className=b},removeClass:function(a,b){if(a.classList)a.classList.remove(b);else if(a.className){var c=a.className.split(" ");c.remove(b),a.className=c.join(" ")}},css:function(b,c,d){if(2==arguments.length){var e=a.getComputedStyle?a.getComputedStyle(b):b.currentStyle,f=e[c];return f}b.style[c]=d},on:function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)},config:function(a,b){N.hasOwnProperty(a)?N[a]=b:M.isPlainObject(a)&&d(N,a)}}),"".startsWith||(String.prototype.startsWith=function(a){return 0===this.indexOf(a)}),Array.prototype.remove=function(a){for(var b=this.length;b--;)a==this[b]&&this.splice(b,1)};var S=/-[^-]/g;N.ajax={type:"GET",dataType:"text"};var T={};k.prototype={$get:function(a,b){if(!~a.indexOf("."))return this.hasOwnProperty(a)?l(this[a]):this.$parent?this.$parent.$get(a):"";for(var c,d=this,e=a.split("."),f=0;f<e.length;f++){if(c=e[f],!d||!d.hasOwnProperty(c))return d[c]?function(){return d[c].apply(d,arguments)}:f||b?"":this.$parent?this.$parent.$get(a):"";if(f==e.length-1)return l(d[c]);d=d[c]}},$set:function(a,b){j(this,a,b),this.$notifySubscribes(a,b)},$subscribe:function(a,b){this.$subscribes[a]||(this.$subscribes[a]=[]),this.$subscribes[a].push(b)},$unsubscribe:function(a,b){this.$subscribes[a]&&this.$subscribes[a].remove(b)},$notifySubscribes:function(a,b){if(!this.$freeze)for(var c=m(this,a),d=0;d<c.length;d++)c[d].update(this,b,a)},$bindElement:function(a){if(a.$modelId)throw new Error("\u4e0d\u80fd\u91cd\u590d\u7ed1\u5b9amodel.");var b=this;if(b.$parent=M.getParentModel(a),b.$parent){b.$parent.$childs.push(b);var c={update:function(a,c,d){b.hasOwnProperty(d)||b.$notifySubscribes(d,c)}};b.$parent.$subscribe("*",c)}a.$modelId=b.$id,this.$element=a},$filter:function(a,b,c){var d=M.filters[a];return d?(arguments.length>2?(c=Array.prototype.slice.call(arguments),c.shift()):c=[b],d.apply(null,c)):b}},d(M,{define:function(a){return new k(a)},getModel:function(a){try{return T[a.$modelId]}catch(b){return null}},getParentModel:function(a){var b=a.$modelId;if(b)return T[b];for(;a=a.parentNode;)if(a.$modelId)return T[a.$modelId];return null},getExtModel:function(a){return M.getModel(a)||M.getParentModel(a)},destroyModel:function(a,b){a.$childs.length&&a.$childs.forEach(function(a){M.destroyModel(a,b)}),delete T[a.$id],a.$element&&(b?a.$element.parentNode.removeChild(a.$element):a.$element.$modelId=void 0),a=null}});if(M.scan=n,!"".trim){var U=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(U,"")}}Array.prototype.forEach||(Array.prototype.forEach=function(a){for(var b=0;b<this.length;b++)a(this[b],b)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(a==this[b])return b;return-1}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]==a)return b;return-1}),Function.prototype.bind||(Function.prototype.bind=function(a){var b=this;return function(){return b.apply(a)}});N.priorities={"x-skip":0,"x-controller":10,"x-each":20,"x-with":30,"x-if":50,href:3e3},M.scanners={},N.booleanBindAttrs=["disabled","checked","selected","contenteditable","draggable","dropzone"],N.booleanBindAttrs.forEach(function(a){M.scanners[a]=s}),N.stringBindAttrs=["target","title","width","height","name","alt","align","valign","clos","rows","clospan","rowspan","cellpadding","cellspacing","method","color","type","border","size","face","color","value","label","wrap"],N.eventBindAttrs=["blur","focus","focusin","focusout","load","resize","scroll","unload","click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","mouseenter","mouseleave","change","select","submit","keydown","keypress","keyup","error","contextmenu"],N.stringBindAttrs.forEach(function(a){M.scanners[a]=t}),"x-src x-href".split(" ").forEach(function(a){M.scanners[a]=u}),N.eventBindAttrs.forEach(function(a){M.scanners["x-"+a]=v}),M.extend(M.scanners,{"x-skip":function(a,b){a.element.removeAttribute(b.name),a.element.$noScanChild=!0},"x-controller":function(a,b){var c=a.value,d=T[c];return a.element.removeAttribute(b.name),d&&!d.element?(d.$bindElement(a.element),d):void 0},"x-template":function(a,b){{var c=a.element,d=a.value,e=M.getParentModel(c);new x(d,c,e)}c.$nextSibling=c.nextSibling,c.$noScanChild=!0,c.removeAttribute(b.name),c.parentNode.removeChild(c)},"x-include":function(a,b){var c=a.element,d=M.getExtModel(c);c.$noScanChild=!0,c.removeAttribute(b.name),g(d,a.value,A,function(a){c.innerHTML="";var b=W[a].element.cloneNode(!0);P&&(b.$noScanChild=!1),c.appendChild(b),n(b,d)})},"x-repeat":function(a,c){var d=(a.value,a.param),e=a.element,f=e.parentNode,h=M.getExtModel(e),i=b.createComment("x-repeat-start:"+d),j=b.createComment("x-repeat-end:"+d);f.insertBefore(i,e),f.insertBefore(j,e.nextSibling),e.$nextSibling=e.nextSibling,e.$noScanChild=!0,e.removeAttribute(c.name),e.parentNode.removeChild(e),g(h,a.value,A,function(a){if(M.isArray(a)){for(var b,c=i.nextSibling;c&&c!=j;)b=M.getModel(c),M.destroyModel(b,!0),c=i.nextSibling;a.forEach(function(b,c){var g=e.cloneNode(!0);P&&(g.$noScanChild=!1);var h=new k({$index:c,$remove:function(){M.destroyModel(h,!0)},$first:!c,$last:c==a.length,$middle:c>0&&c<a.length});h[d]=b,f.insertBefore(g,j),h.$bindElement(g),n(g,h)})}})},"x-if":function(a,c){var d=a.element,e=d.parentElement,f=M.getModel(d)||new k,h=M.getParentModel(d),i=b.createComment("x-if:"+f.$id);return d.$nextSibling=d.nextSibling,d.removeAttribute(c.name),d.$modelId||f.$bindElement(d),g(h,a.value,A,function(a){if(a){d.parentElement||e.replaceChild(d,i),f.$freeze=!1;for(var b in f.$subscribes)f.$notifySubscribes(b)}else d.parentElement&&e.replaceChild(i,d),f.$freeze=!0}),f},"x-show":function(a,b){var c=M.getExtModel(a.element);a.element.removeAttribute(b.name),g(c,a.value,A,function(b){a.element.style.display=b?"":"none"})},"x-bind":function(a,b){function c(b){M.on(a.element,b,function(){d.$set(a.value,a.element.value)})}var d=M.getExtModel(a.element);a.element.removeAttribute(b.name),g(d,a.value,A,function(b){var c=a.element,d=!0;"INPUT"==c.tagName&&("radio"==c.type?(d=!1,c.checked=b==c.value?!0:!1):"checkbox"==c.type&&(d=!1,c.checked=~b.indexOf(c.value)?!0:!1)),d&&(c.value=b),c.name&&c.form&&c.form.$xform&&w(c)});var d=M.getExtModel(a.element);switch(a.element.tagName){case"INPUT":switch(a.element.type){case"checkbox":var e=d.$get(a.value);if(e&&!M.isArray(e))throw new TypeError("Checkbox bind must be array.");e||d.$set(a.value,[]),M.on(a.element,"click",function(b){var c=P?b.srcElement:this,e=d.$get(a.value),f=c.value;c.checked?e.push(f):e.remove(f),d.$set(a.value,e)});break;case"radio":M.on(a.element,"click",function(b){d.$set(a.value,P?b.srcElement.value:this.value)});break;default:c("keyup"),c("change")}break;case"SELECT":M.on(a.element,"change",function(){var b,c;O?(c=a.element.options[a.element.selectedIndex],b=c.attributes.value.specified?c.value:c.text):b=P?a.element.options[a.element.selectedIndex].value:this.value,d.$set(a.value,b)});break;case"TEXTAREA":c("keyup"),c("change")}},"x-class":function(a,b){var c=a.element;c.removeAttribute(b.name),g(a.model,a.value,A,function(b){b?M.addClass(a.element,a.param):M.removeClass(a.element,a.param)})},"x-ajax":function(a,b){var c=a.element,d=M.getModel(c)||new k;c.removeAttribute(b.name),c.$modelId||d.$bindElement(c);var e=function(){h({type:"GET",dataType:"json",cache:!1,url:a.value,success:function(b){for(var c in b)d.$set(a.param+"."+c,b[c])},error:function(b,c){d.$set(a.param+".$error",c)}})};return e(),d[a.param]={$read:e},d},"x-grid":function(a,b){var c=a.element,d=M.getModel(c)||new k;c.removeAttribute(b.name),c.$modelId||d.$bindElement(c);var e=a.param,f={name:e,url:b.value,page:c.getAttribute("page"),pageSize:c.getAttribute("page-size")};return d[e]=new y(f),d[e].$$model=d,d},"x-style":function(a,b){var c=f(a.param);a.element.removeAttribute(b.name),g(a.model,a.value,A,function(b){a.element.style[c]=b})},"x-form":function(a,b){var c=M.getExtModel(a.element);return a.element.removeAttribute(b.name),c||(c=new k,c.$bindElement(a.element)),d(c,{$dirty:!1,$valid:!0}),a.element.$xform=a.param,c}});var V={min:function(a,b){return b.length>=+a},max:function(a,b){return b.length<=+a},pattern:function(a,b){return new RegExp(a).test(b)},type:function(a,b){var c=Q[a.toLowerCase()];return c?ret.test(b):!0},required:function(a,b){return!!b}},W={};y.prototype={$read:function(a){arguments.length&&(this.$$params=a,this.$$page=1);var b=this,c=this.$$params;d(c,{page:this.$$page,pageSize:this.$$pageSize}),this.$$sort&&(c.sort=this.$$sort),this.$$order&&(c.order=this.$$order),h({type:"GET",dataType:"json",cache:!1,url:this.$$url,data:c,success:function(a){for(var c in a)b.$$model.$set(b.$$name+"."+c,a[c])},error:function(a,c){b.$$model.$set(b.$$name+".$error",c)}})},$page:function(a){return a?(this.$$page=a,void this.$read()):this.$$page},$pageSize:function(a){return a?(this.$$pageSize=a,this.$$page=1,this.$read(),void 0):this.$$pageSize},$sort:function(a,b){this.$$sort=a,this.$$order=b||"",this.$read()}};var X=/(\w+)(.*)/,Y=/[^\w\$\.]+/g,Z=/^\-?\d?\.?\d+$/,$=a.JSON?a.JSON.parse:function(a){return new Function("","return "+a.trim())()};M.filters={date:function(a,b){var c=H(a);return K(c,b)},limit:function(a,b,c){return a.length<=b?a:(c=c||"...",a.substring(0,b)+c)},number:function(a,b){return a=+a,a.toFixed(b)}};var _={yyyy:function(a){return a.getFullYear()},mm:function(a){return L(a.getMonth()+1)},m:function(a){return a.getMonth()+1},dd:function(a){return L(a.getDate())},d:function(a){return a.getDate()},hh:function(a){return L(a.getHours())},h:function(a){return a.getHours()},MM:function(a){return L(a.getMinutes())},M:function(a){return a.getMinutes()},ss:function(a){return L(a.getSeconds())},s:function(a){return a.getSeconds()},l:function(){return""},ww:function(a){var b="\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("");return"\u661f\u671f"+b[a.getDay()]},w:function(a){var b="\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("");return"\u5468"+b[a.getDay()]}};M.filters.date.format=function(a,b){_[a]=b},M.ready(n),a.vmodel=M}(window,window.document,window.location,window.history);